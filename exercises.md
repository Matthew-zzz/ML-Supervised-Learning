# Регрессии и метрики — практические задачи для ML

## 1. Линейная регрессия (Regression)

### 1.1 Аналитическое решение через нормальные уравнения

**Задача 1 — Предсказание цены**

### Вводные данные

Табличный датасет с признаками:

```

Площадь (м²)
Количество комнат
Возраст дома

```

Целевая переменная:

```

Цена (в €)

````

Можно использовать датасет из `sklearn.datasets` или любой CSV.

---

### Задача

1. Добавить столбец единиц (bias).
2. Реализовать линейную регрессию через нормальное уравнение:

$$
w = (X^T X)^{-1} X^T y
$$

3. Реализовать предсказание:

$$
\hat{y} = Xw
$$

4. Сравнить веса и предсказания с моделью:

sklearn.linear_model.LinearRegression

---

### Что найти

* Вектор весов
* Предсказания на тестовой выборке
* Разницу между ручной реализацией и sklearn
* Интерпретацию коэффициентов

---

### 1.2 Градиентный спуск для линейной регрессии

**Задача 2 — Оптимизация через итерации**

### Вводные данные

Тот же датасет.

---

### Задача

1. Реализовать функцию ошибки MSE:

$$
J(w) = \frac{1}{n} \sum (y - \hat{y})^2
$$

2. Вывести градиент.

3. Реализовать градиентный спуск:

$$
w := w - \alpha \nabla J(w)
$$

4. Построить график сходимости ошибки.

---

### Что найти

* Скорость сходимости
* Влияние learning rate
* Сравнение решения с аналитическим методом

---

## 2. Логистическая регрессия (Classification)

### 2.1 Реализация логистической регрессии

**Задача 3 — Классификация “дорогой / недорогой”**

### Вводные данные

Признаки:

```
Площадь
Локация (числовой код)
Возраст
```

Целевая метка:

```
0 — недорогой
1 — дорогой
```

---

### Задача

1. Реализовать сигмоиду:

$$
\sigma(z) = \frac{1}{1 + e^{-z}}
$$

2. Реализовать логистическую функцию потерь (log-loss).
3. Реализовать градиентный спуск.
4. Добавить threshold = 0.5 для классификации.
5. Сравнить с:

sklearn.linear_model.LogisticRegression

---

### Что найти

* Вектор весов
* Значения вероятностей
* Классы после threshold
* Разницу с sklearn

---

## 3. Метрики качества моделей

### 3.1 Метрики для регрессии

**Задача 4 — Оценка качества предсказаний**

### Задача

Реализовать вручную:

* MAE
* MSE
* RMSE
* R²

Сравнить с:

sklearn.metrics

---

### Что найти

* Значения метрик
* Как меняются метрики при выбросах
* Почему MSE сильнее штрафует большие ошибки

---

### 3.2 Метрики для классификации

**Задача 5 — Анализ качества классификации**

### Задача

1. Построить confusion matrix.
2. Реализовать вручную:

   * accuracy
   * precision
   * recall
   * F1
3. Посчитать ROC-AUC.
4. Построить ROC-кривую.

Сравнить с:

sklearn.metrics

---

### Что найти

* TP, FP, TN, FN
* Когда accuracy вводит в заблуждение
* Почему F1 важна при дисбалансе классов
* Интерпретацию ROC-AUC

---

## 4. Сравнение моделей

**Задача 6 — Сравнение подходов**

### Задача

1. Разделить данные на train/test.
2. Сравнить:

   * линейную регрессию (аналитика vs градиент)
   * логистическую регрессию (ручная vs sklearn)
3. Проанализировать:

   * переобучение
   * стабильность коэффициентов
   * чувствительность к масштабу признаков

---

### Что найти

* Разницу в качестве моделей
* Влияние нормализации
* Влияние размера выборки

---



